<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="../../_static/favicon.ico">
    <title>gino.crud module - GINO 1.0.0rc1 文档</title>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async
            src="https://www.googletagmanager.com/gtag/js?id=UA-3759436-10"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag () {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-3759436-10');
    </script>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css">
    <link type="text/css" rel="stylesheet"
          href="../../_static/css/materialize.min.css"
          media="screen,projection"/>
    <link rel="stylesheet" href="../../_static/pygments.css"
          type="text/css"/>
    <link type="text/css" rel="stylesheet"
          href="../../_static/css/gino.css"/>
</head>
<body>

<header>
    <div class="navbar-fixed">
        <nav>
            <div class="nav-wrapper">
                <a href="../../index.html" class="brand-logo">
                    <div class="img"
                         style="background-image: url(../../_static/logo.png); width: 40px; height: 40px; margin-right: 8px"></div>
                    <div class="img"
                         style="background-image: url(../../_static/logo-name.png); width: 100px; height: 32.5px; margin-top: 4px"></div>
                </a>
                <div class="breadcrumbs">
                    <a class="breadcrumb" style="display: none"></a>
                    
                        <a href="../../reference.html"
                           class="breadcrumb">参考手册</a>
                    
                        <a href="../api.html"
                           class="breadcrumb">API 参考</a>
                    
                        <a href="gino.html"
                           class="breadcrumb">gino package</a>
                    
                    
                        <a class="breadcrumb" style="color: #FFFFFF">gino.crud module</a>
                    
                </div>
                <div class="spacer"></div>
                <div class="search">
                    <input type="text" id="search" placeholder="Search">
                    <i class="mdi mdi-magnify"></i>
                </div>
                <a class="waves-effect waves-light btn-flat theme-dark" href="/">
                    <i class="mdi mdi-home"></i>
                    Home
                </a>
                <a class="waves-effect waves-light btn-flat theme-dark"
                   href="/authors.html">
                    <i class="mdi mdi-account-group"></i>
                    Authors
                </a>
                <a href="https://github.com/python-gino/gino" target="_blank"
                   class="github">
                    <i class="mdi mdi-github-circle"></i>
                </a>
            </div>
        </nav>
    </div>

    <div id="sidenav" class="sidenav sidenav-fixed">
        <p class="caption"><span class="caption-text">上手教程</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">上手教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorial.html">上手教程</a></li>
</ul>
<p class="caption"><span class="caption-text">进阶用法</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../how-to.html">进阶用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/contributing.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/crud.html">CRUD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/loaders.html">Loaders and Relationship</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/pool.html">Connection Pool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/sanic.html">Sanic Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/schema.html">Schema Declaration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/starlette.html">Starlette Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/tornado.html">Tornado Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/transaction.html">Transaction</a></li>
</ul>
<p class="caption"><span class="caption-text">原理说明</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../explanation.html">原理说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../explanation/engine.html">Engine and Connection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../explanation/why.html">Why Asynchronous ORM?</a></li>
</ul>
<p class="caption"><span class="caption-text">参考手册</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../reference.html">参考手册</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html">API 参考</a></li>
<li class="toctree-l2"><a class="reference internal" href="../authors.html">制作人员</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history.html">History</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API 参考</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="gino.html">gino package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">制作人员</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
</ul>

    </div>
</header>

<main>
    <div class="row">
        <div class="col s12 m9 body">
            
    <div class="section" id="module-gino.crud">
<span id="gino-crud-module"></span><h1>gino.crud module<a class="headerlink" href="#module-gino.crud" title="永久链接至标题">¶</a></h1>
<dl class="class">
<dt id="gino.crud.Alias">
<em class="property">class </em><code class="sig-prename descclassname">gino.crud.</code><code class="sig-name descname">Alias</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.Alias" title="永久链接至目标">¶</a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(在 Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Experimental proxy for table alias on model.</p>
<dl class="method">
<dt id="gino.crud.Alias.distinct">
<code class="sig-name descname">distinct</code><span class="sig-paren">(</span><em class="sig-param">*columns</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.Alias.distinct" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gino.crud.Alias.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">*column_names</em>, <em class="sig-param">**relationships</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.Alias.load" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gino.crud.Alias.on">
<code class="sig-name descname">on</code><span class="sig-paren">(</span><em class="sig-param">on_clause</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.Alias.on" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="gino.crud.CRUDModel">
<em class="property">class </em><code class="sig-prename descclassname">gino.crud.</code><code class="sig-name descname">CRUDModel</code><span class="sig-paren">(</span><em class="sig-param">**values</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel" title="永久链接至目标">¶</a></dt>
<dd><p>基类：<a class="reference internal" href="gino.declarative.html#gino.declarative.Model" title="gino.declarative.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">gino.declarative.Model</span></code></a></p>
<p>The base class for models with CRUD support.</p>
<p>Don't inherit from this class directly, because it has no metadata. Use
<a class="reference internal" href="gino.api.html#gino.api.Gino.Model" title="gino.api.Gino.Model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">db.Model</span></code></a> instead.</p>
<dl class="method">
<dt id="gino.crud.CRUDModel.alias">
<em class="property">classmethod </em><code class="sig-name descname">alias</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.alias" title="永久链接至目标">¶</a></dt>
<dd><p>Experimental proxy for table alias on model.</p>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.append_where_primary_key">
<code class="sig-name descname">append_where_primary_key</code><span class="sig-paren">(</span><em class="sig-param">q</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.append_where_primary_key" title="永久链接至目标">¶</a></dt>
<dd><p>Append where clause to locate this model instance by primary on the
given query, and return the new query.</p>
<p>This is mostly used internally in GINO, but also available for such
usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">user</span><span class="o">.</span><span class="n">append_where_primary_key</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="p">)</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<p>which is identical to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">user</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">0.7.6 版后已移除: </span>Use <a class="reference internal" href="#gino.crud.CRUDModel.lookup" title="gino.crud.CRUDModel.lookup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lookup()</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.create">
<code class="sig-name descname">create</code><span class="sig-paren">(</span><em class="sig-param">bind=None</em>, <em class="sig-param">timeout=&lt;object object&gt;</em>, <em class="sig-param">**values</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.create" title="永久链接至目标">¶</a></dt>
<dd><p>This <code class="docutils literal notranslate"><span class="pre">create</span></code> behaves a bit different on model classes compared to model
instances.</p>
<p>On model classes, <code class="docutils literal notranslate"><span class="pre">create</span></code> will create a new model instance and insert
it into database. On model instances, <code class="docutils literal notranslate"><span class="pre">create</span></code> will just insert the
instance into the database.</p>
<p>Under the hood <a class="reference internal" href="#gino.crud.CRUDModel.create" title="gino.crud.CRUDModel.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> uses <code class="docutils literal notranslate"><span class="pre">INSERT</span> <span class="pre">...</span> <span class="pre">RETURNING</span> <span class="pre">...</span></code> to
create the new model instance and load it with database default data if
not specified.</p>
<p>Some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user1</span> <span class="o">=</span> <span class="k">await</span> <span class="n">User</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;fantix&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">user2</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;gino&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="k">await</span> <span class="n">user2</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bind</strong> -- A <a class="reference internal" href="gino.engine.html#gino.engine.GinoEngine" title="gino.engine.GinoEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">GinoEngine</span></code></a> to execute the
<code class="docutils literal notranslate"><span class="pre">INSERT</span></code> statement with, or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default) to use the bound
engine on the metadata (<a class="reference internal" href="gino.api.html#gino.api.Gino" title="gino.api.Gino"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gino</span></code></a>).</p></li>
<li><p><strong>timeout</strong> -- Seconds to wait for the database to finish executing,
<code class="docutils literal notranslate"><span class="pre">None</span></code> for wait forever. By default it will use the <code class="docutils literal notranslate"><span class="pre">timeout</span></code>
execution option value if unspecified.</p></li>
<li><p><strong>values</strong> -- Keyword arguments are pairs of attribute names and their
initial values. Only available when called on a model class.</p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p>The instance of this model class (newly created or existing).</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="gino.crud.CRUDModel.delete">
<code class="sig-name descname">delete</code><a class="headerlink" href="#gino.crud.CRUDModel.delete" title="永久链接至目标">¶</a></dt>
<dd><p>Similar to <a class="reference internal" href="#gino.crud.UpdateRequest.update" title="gino.crud.UpdateRequest.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a>, this <code class="docutils literal notranslate"><span class="pre">delete</span></code> is also different on model
classes than on model instances.</p>
<p>On model classes <code class="docutils literal notranslate"><span class="pre">delete</span></code> is an attribute of type
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/dml.html#sqlalchemy.sql.expression.Delete" title="(在 SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Delete</span></code></a> for massive deletes, for
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">User</span><span class="o">.</span><span class="n">delete</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">enabled</span><span class="o">.</span><span class="n">is_</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">status</span><span class="p">()</span>
</pre></div>
</div>
<p>Similarly you can add a <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/dml.html#sqlalchemy.sql.expression.Delete.returning" title="(在 SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">returning()</span></code></a>
clause to the query and it shall return the deleted rows as model objects.</p>
<p>And on model instances, <code class="docutils literal notranslate"><span class="pre">delete()</span></code> is a method to remove the
corresponding row in the database of this model instance. and returns the
status returned from the database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="k">await</span> <span class="n">user</span><span class="o">.</span><span class="n">delete</span><span class="p">())</span>  <span class="c1"># e.g. prints DELETE 1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p><code class="docutils literal notranslate"><span class="pre">delete()</span></code> only removes the row from database, it does not affect the
current model instance.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bind</strong> -- An optional <a class="reference internal" href="gino.engine.html#gino.engine.GinoEngine" title="gino.engine.GinoEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">GinoEngine</span></code></a> if current
metadata (<a class="reference internal" href="gino.api.html#gino.api.Gino" title="gino.api.Gino"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gino</span></code></a>) has no bound engine, or specifying a
different <a class="reference internal" href="gino.engine.html#gino.engine.GinoEngine" title="gino.engine.GinoEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">GinoEngine</span></code></a> to execute the <code class="docutils literal notranslate"><span class="pre">DELETE</span></code>.</p></li>
<li><p><strong>timeout</strong> -- Seconds to wait for the database to finish executing,
<code class="docutils literal notranslate"><span class="pre">None</span></code> for wait forever. By default it will use the <code class="docutils literal notranslate"><span class="pre">timeout</span></code>
execution option value if unspecified.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.distinct">
<em class="property">classmethod </em><code class="sig-name descname">distinct</code><span class="sig-paren">(</span><em class="sig-param">*columns</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.distinct" title="永久链接至目标">¶</a></dt>
<dd><p>Experimental loader feature to yield only distinct instances by given
columns.</p>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.get">
<em class="property">classmethod </em><code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">ident</em>, <em class="sig-param">bind=None</em>, <em class="sig-param">timeout=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.get" title="永久链接至目标">¶</a></dt>
<dd><p>Get an instance of this model class by primary key.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">User</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">))</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ident</strong> -- Value of the primary key. For composite primary keys this
should be a tuple of values for all keys in database order, or a dict
of names (or position numbers in database order starting from zero)
of all primary keys to their values.</p></li>
<li><p><strong>bind</strong> -- A <a class="reference internal" href="gino.engine.html#gino.engine.GinoEngine" title="gino.engine.GinoEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">GinoEngine</span></code></a> to execute the
<code class="docutils literal notranslate"><span class="pre">INSERT</span></code> statement with, or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default) to use the bound
engine on the metadata (<a class="reference internal" href="gino.api.html#gino.api.Gino" title="gino.api.Gino"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gino</span></code></a>).</p></li>
<li><p><strong>timeout</strong> -- Seconds to wait for the database to finish executing,
<code class="docutils literal notranslate"><span class="pre">None</span></code> for wait forever. By default it will use the <code class="docutils literal notranslate"><span class="pre">timeout</span></code>
execution option value if unspecified.</p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p>An instance of this model class, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no such row.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.in_query">
<em class="property">classmethod </em><code class="sig-name descname">in_query</code><span class="sig-paren">(</span><em class="sig-param">query</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.in_query" title="永久链接至目标">¶</a></dt>
<dd><p>Convenient method to get a Model object when using subqueries.</p>
<p>Though with filters and aggregations, subqueries often return same
columns as the original table, but SQLAlchemy could not recognize them
as the columns are in subqueries, so technically they're columns in the
new &quot;table&quot;.</p>
<p>With this method, the columns are loaded into the origintal models when
being used in subquries. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s1">&#39;users&#39;</span><span class="p">)</span>
<span class="n">MyUser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">in_query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">MyUser</span><span class="o">.</span><span class="n">distinct</span><span class="p">(</span><span class="n">User1</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">users</span> <span class="o">=</span> <span class="k">await</span> <span class="n">query</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.load">
<em class="property">classmethod </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">*column_names</em>, <em class="sig-param">**relationships</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.load" title="永久链接至目标">¶</a></dt>
<dd><p>Populates a <a class="reference internal" href="gino.loader.html#gino.loader.Loader" title="gino.loader.Loader"><code class="xref py py-class docutils literal notranslate"><span class="pre">loader.Loader</span></code></a> instance to be used by the
<code class="docutils literal notranslate"><span class="pre">loader</span></code> execution option in order to customize the loading behavior
to load specified fields into instances of this model.</p>
<p>The basic usage of this method is to provide the <code class="docutils literal notranslate"><span class="pre">loader</span></code> execution
option (if you are looking for reloading
the instance from database, check <a class="reference internal" href="#gino.crud.CRUDModel.get" title="gino.crud.CRUDModel.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get()</span></code></a> or <a class="reference internal" href="#gino.crud.CRUDModel.query" title="gino.crud.CRUDModel.query"><code class="xref py py-attr docutils literal notranslate"><span class="pre">query</span></code></a>) for a
given query.</p>
<p>This method takes both positional arguments and keyword arguments with
very different meanings. The positional arguments should be column
names as strings, specifying only these columns should be loaded into
the model instance (other values are discarded even if they are
retrieved from database). Meanwhile, the keyword arguments should be
loaders for instance attributes. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="k">await</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p><code class="docutils literal notranslate"><span class="pre">gino.load</span></code> is a shortcut for setting the execution option
<code class="docutils literal notranslate"><span class="pre">loader</span></code>.</p>
</div>
<p>This will populate a <code class="docutils literal notranslate"><span class="pre">User</span></code> instance with only <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code>
values, all the rest are simply <code class="docutils literal notranslate"><span class="pre">None</span></code> even if the query actually
returned all the column values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
<span class="n">u</span> <span class="o">=</span> <span class="k">await</span> <span class="n">q</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">Team</span><span class="p">))</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<p>This will load two instances of model <code class="docutils literal notranslate"><span class="pre">User</span></code> and <code class="docutils literal notranslate"><span class="pre">Team</span></code>, returning
the <code class="docutils literal notranslate"><span class="pre">User</span></code> instance with <code class="docutils literal notranslate"><span class="pre">u.team</span></code> set to the <code class="docutils literal notranslate"><span class="pre">Team</span></code> instance.</p>
<p>Both positional and keyword arguments can be used ath the same time. If
they are both omitted, like <code class="docutils literal notranslate"><span class="pre">Team.load()</span></code>, it is equivalent to just
<code class="docutils literal notranslate"><span class="pre">Team</span></code> as a loader.</p>
<p>Additionally, a <a class="reference internal" href="gino.loader.html#gino.loader.Loader" title="gino.loader.Loader"><code class="xref py py-class docutils literal notranslate"><span class="pre">loader.Loader</span></code></a> instance can also be used to
generate queries, as its structure is usually the same as the query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="k">await</span> <span class="n">User</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">team</span><span class="o">=</span><span class="n">Team</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<p>This generates a query like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">users</span><span class="o">.</span><span class="n">xxx</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">teams</span><span class="o">.</span><span class="n">xxx</span><span class="p">,</span> <span class="o">...</span>
  <span class="n">FROM</span> <span class="n">users</span> <span class="n">LEFT</span> <span class="n">JOIN</span> <span class="n">teams</span>
    <span class="n">ON</span> <span class="o">...</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="gino.loader.html#gino.loader.Loader" title="gino.loader.Loader"><code class="xref py py-class docutils literal notranslate"><span class="pre">Loader</span></code></a> delegates attributes on the <code class="docutils literal notranslate"><span class="pre">query</span></code>, so
<code class="docutils literal notranslate"><span class="pre">.query</span></code> can be omitted. The <code class="docutils literal notranslate"><span class="pre">LEFT</span> <span class="pre">JOIN</span></code> is built-in behavior,
while the <code class="docutils literal notranslate"><span class="pre">ON</span></code> clause is generated based on foreign key. If there is
no foreign key, or the condition should be customized, you can use
this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="k">await</span> <span class="n">User</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
    <span class="n">team</span><span class="o">=</span><span class="n">Team</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">team_id</span> <span class="o">==</span> <span class="n">Team</span><span class="o">.</span><span class="n">id</span><span class="p">))</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<p>And you can use both <a class="reference internal" href="#gino.crud.CRUDModel.load" title="gino.crud.CRUDModel.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a> and <a class="reference internal" href="#gino.crud.CRUDModel.on" title="gino.crud.CRUDModel.on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">on()</span></code></a> at the same time
in a chain, in whatever order suits you.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="gino.engine.html#gino.engine.GinoConnection.execution_options" title="gino.engine.GinoConnection.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execution_options()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.lookup">
<code class="sig-name descname">lookup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.lookup" title="永久链接至目标">¶</a></dt>
<dd><p>Generate where-clause expression to locate this model instance.</p>
<p>By default this method uses current values of all primary keys, and you
can override it to behave differently. Most instance-level CRUD
operations depend on this method internally. Particularly while
<a class="reference internal" href="#gino.crud.CRUDModel.lookup" title="gino.crud.CRUDModel.lookup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lookup()</span></code></a> is called in <a class="reference internal" href="#gino.crud.UpdateRequest.update" title="gino.crud.UpdateRequest.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a>, the where condition is
used in <a class="reference internal" href="#gino.crud.UpdateRequest.apply" title="gino.crud.UpdateRequest.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UpdateRequest.apply()</span></code></a>, so that queries like <code class="docutils literal notranslate"><span class="pre">UPDATE</span> <span class="pre">...</span>
<span class="pre">SET</span> <span class="pre">id</span> <span class="pre">=</span> <span class="pre">NEW</span> <span class="pre">WHERE</span> <span class="pre">id</span> <span class="pre">=</span> <span class="pre">OLD</span></code> could work correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">返回</dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified added">0.7.6 新版功能.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.none_as_none">
<em class="property">classmethod </em><code class="sig-name descname">none_as_none</code><span class="sig-paren">(</span><em class="sig-param">enabled=True</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.none_as_none" title="永久链接至目标">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.on">
<em class="property">classmethod </em><code class="sig-name descname">on</code><span class="sig-paren">(</span><em class="sig-param">on_clause</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.on" title="永久链接至目标">¶</a></dt>
<dd><p>Customize the on-clause for the auto-generated outer join query.</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>This has no effect when provided as the <code class="docutils literal notranslate"><span class="pre">loader</span></code> execution option
for a given query.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#gino.crud.CRUDModel.load" title="gino.crud.CRUDModel.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="gino.crud.CRUDModel.query">
<code class="sig-name descname">query</code><a class="headerlink" href="#gino.crud.CRUDModel.query" title="永久链接至目标">¶</a></dt>
<dd><p>Get a SQLAlchemy query clause of the table behind this model. This equals
to <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/selectable.html#sqlalchemy.sql.expression.select" title="(在 SQLAlchemy v1.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sqlalchemy.select([self.__table__])</span></code></a>. If this attribute is retrieved on a
model instance, then a where clause to locate this instance by its primary
key is appended to the returning query clause. This model type is set as
the execution option <code class="docutils literal notranslate"><span class="pre">model</span></code> in the returning clause, so by default the
query yields instances of this model instead of database rows.</p>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.select">
<code class="sig-name descname">select</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.select" title="永久链接至目标">¶</a></dt>
<dd><p>Build a query to retrieve only specified columns from this table.</p>
<p>This method accepts positional string arguments as names of attributes to
retrieve, and returns a <a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/selectable.html#sqlalchemy.sql.expression.Select" title="(在 SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Select</span></code></a> for
query. The returning query object is always set with two execution options:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">model</span></code> is set to this model type</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return_model</span></code> is set to <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li>
</ol>
<p>So that by default it always return rows instead of model instances, while
column types can be inferred correctly by the <code class="docutils literal notranslate"><span class="pre">model</span></code> option.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">iterate</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>If <a class="reference internal" href="#gino.crud.CRUDModel.select" title="gino.crud.CRUDModel.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select()</span></code></a> is invoked on a model instance, then a <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clause
to locate this instance by its primary key is appended to the returning
query clause. This is useful when you want to retrieve a latest value of a
field on current model instance from database:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db_age</span> <span class="o">=</span> <span class="k">await</span> <span class="n">user</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="gino.engine.html#gino.engine.GinoConnection.execution_options" title="gino.engine.GinoConnection.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execution_options()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="gino.crud.CRUDModel.to_dict">
<code class="sig-name descname">to_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.CRUDModel.to_dict" title="永久链接至目标">¶</a></dt>
<dd><p>Convenient method to generate a dict from this model instance.</p>
<p>Keys will be attribute names, while values are loaded from memory (not
from database). If there are <a class="reference internal" href="gino.json_support.html#gino.json_support.JSONProperty" title="gino.json_support.JSONProperty"><code class="xref py py-class docutils literal notranslate"><span class="pre">JSONProperty</span></code></a>
attributes in this model, their source JSON field will not be included
in the returning dict - instead the JSON attributes will be.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="gino.json_support.html#module-gino.json_support" title="gino.json_support"><code class="xref py py-mod docutils literal notranslate"><span class="pre">json_support</span></code></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="gino.crud.CRUDModel.update">
<code class="sig-name descname">update</code><a class="headerlink" href="#gino.crud.CRUDModel.update" title="永久链接至目标">¶</a></dt>
<dd><p>This <code class="docutils literal notranslate"><span class="pre">update</span></code> behaves quite different on model classes rather than model
instances.</p>
<p>On model classes, <code class="docutils literal notranslate"><span class="pre">update</span></code> is an attribute of type
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/dml.html#sqlalchemy.sql.expression.Update" title="(在 SQLAlchemy v1.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Update</span></code></a> for massive updates, for
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">User</span><span class="o">.</span><span class="n">update</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">status</span><span class="p">()</span>
</pre></div>
</div>
<p>Like <a class="reference internal" href="#gino.crud.CRUDModel.query" title="gino.crud.CRUDModel.query"><code class="xref py py-attr docutils literal notranslate"><span class="pre">query</span></code></a>, the update query also has the <code class="docutils literal notranslate"><span class="pre">model</span></code> execution
option of this model, so if you use the
<a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/dml.html#sqlalchemy.sql.expression.Update.returning" title="(在 SQLAlchemy v1.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">returning()</span></code></a> clause, the query shall
return model objects.</p>
<p>However on model instances, <code class="docutils literal notranslate"><span class="pre">update()</span></code> is a method which accepts keyword
arguments only and returns an <a class="reference internal" href="#gino.crud.UpdateRequest" title="gino.crud.UpdateRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdateRequest</span></code></a> to update this single
model instance. The keyword arguments are pairs of attribute names and new
values. This is the same as <a class="reference internal" href="#gino.crud.UpdateRequest.update" title="gino.crud.UpdateRequest.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UpdateRequest.update()</span></code></a>, feel free to
read more about it. A normal usage example would be like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">user</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;new name&#39;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</pre></div>
</div>
<p>Here, the <a class="reference internal" href="#gino.crud.UpdateRequest.apply" title="gino.crud.UpdateRequest.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">await</span> <span class="pre">...</span> <span class="pre">apply()</span></code></a> executes the
actual <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> SQL in the database, while <code class="docutils literal notranslate"><span class="pre">user.update()</span></code> only makes
changes in the memory, and collect all changes into an
<a class="reference internal" href="#gino.crud.UpdateRequest" title="gino.crud.UpdateRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdateRequest</span></code></a> instance.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gino.crud.QueryModel">
<em class="property">class </em><code class="sig-prename descclassname">gino.crud.</code><code class="sig-name descname">QueryModel</code><a class="headerlink" href="#gino.crud.QueryModel" title="永久链接至目标">¶</a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(在 Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></a></p>
<p>Metaclass of Model classes used for subqueries.</p>
</dd></dl>

<dl class="class">
<dt id="gino.crud.UpdateRequest">
<em class="property">class </em><code class="sig-prename descclassname">gino.crud.</code><code class="sig-name descname">UpdateRequest</code><span class="sig-paren">(</span><em class="sig-param">instance: gino.crud.CRUDModel</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.UpdateRequest" title="永久链接至目标">¶</a></dt>
<dd><p>基类：<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(在 Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A collection of attributes and their new values to update on one model
instance.</p>
<p><a class="reference internal" href="#gino.crud.UpdateRequest" title="gino.crud.UpdateRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdateRequest</span></code></a> instances are created by <a class="reference internal" href="#gino.crud.CRUDModel.update" title="gino.crud.CRUDModel.update"><code class="xref py py-attr docutils literal notranslate"><span class="pre">CRUDModel.update</span></code></a>,
don't instantiate manually unless required. Every <a class="reference internal" href="#gino.crud.UpdateRequest" title="gino.crud.UpdateRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdateRequest</span></code></a>
instance is bound to one model instance, all updates are for that one
specific model instance and its database row.</p>
<dl class="method">
<dt id="gino.crud.UpdateRequest.apply">
<em class="property">async </em><code class="sig-name descname">apply</code><span class="sig-paren">(</span><em class="sig-param">bind=None</em>, <em class="sig-param">timeout=&lt;object object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.UpdateRequest.apply" title="永久链接至目标">¶</a></dt>
<dd><p>Apply pending updates into database by executing an <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> SQL.</p>
<dl class="field-list simple">
<dt class="field-odd">参数</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bind</strong> -- A <a class="reference internal" href="gino.engine.html#gino.engine.GinoEngine" title="gino.engine.GinoEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">GinoEngine</span></code></a> to execute the SQL, or
<code class="docutils literal notranslate"><span class="pre">None</span></code> (default) to use the bound engine in the metadata.</p></li>
<li><p><strong>timeout</strong> -- Seconds to wait for the database to finish executing,
<code class="docutils literal notranslate"><span class="pre">None</span></code> for wait forever. By default it will use the <code class="docutils literal notranslate"><span class="pre">timeout</span></code>
execution option value if unspecified.</p></li>
</ul>
</dd>
<dt class="field-even">返回</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">self</span></code> for chaining calls.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="gino.crud.UpdateRequest.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param">**values</em><span class="sig-paren">)</span><a class="headerlink" href="#gino.crud.UpdateRequest.update" title="永久链接至目标">¶</a></dt>
<dd><p>Set given attributes on the bound model instance, and add them into
the update collections for <a class="reference internal" href="#gino.crud.UpdateRequest.apply" title="gino.crud.UpdateRequest.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a>.</p>
<p>Given keyword-only arguments are pairs of attribute names and values to
update. This is not a coroutine, calling <a class="reference internal" href="#gino.crud.UpdateRequest.update" title="gino.crud.UpdateRequest.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> will have
instant effect on the bound model instance - its in-memory values will
be updated immediately. Therefore this can be used individually as a
shortcut to update several attributes in a batch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">age</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">disabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#gino.crud.UpdateRequest.update" title="gino.crud.UpdateRequest.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> returns <code class="docutils literal notranslate"><span class="pre">self</span></code> for chaining calls to either
<a class="reference internal" href="#gino.crud.UpdateRequest.apply" title="gino.crud.UpdateRequest.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> or another <a class="reference internal" href="#gino.crud.UpdateRequest.update" title="gino.crud.UpdateRequest.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a>. If one attribute is updated
several times by the same <a class="reference internal" href="#gino.crud.UpdateRequest" title="gino.crud.UpdateRequest"><code class="xref py py-class docutils literal notranslate"><span class="pre">UpdateRequest</span></code></a>, then only the last
value is remembered for <a class="reference internal" href="#gino.crud.UpdateRequest.apply" title="gino.crud.UpdateRequest.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a>.</p>
<p>Updated values can be SQLAlchemy expressions, for example an atomic
increment for user balance looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">await</span> <span class="n">user</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">balance</span><span class="o">=</span><span class="n">User</span><span class="o">.</span><span class="n">balance</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>Expression values will not affect the in-memory attribute value on
<a class="reference internal" href="#gino.crud.UpdateRequest.update" title="gino.crud.UpdateRequest.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> before <a class="reference internal" href="#gino.crud.UpdateRequest.apply" title="gino.crud.UpdateRequest.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a>, because it has no knowledge
of the latest value in the database. After <a class="reference internal" href="#gino.crud.UpdateRequest.apply" title="gino.crud.UpdateRequest.apply"><code class="xref py py-meth docutils literal notranslate"><span class="pre">apply()</span></code></a> the new
value will be automatically reloaded from database with
<code class="docutils literal notranslate"><span class="pre">RETURNING</span></code> clause.</p>
</div>
</dd></dl>

</dd></dl>

</div>


        </div>

        <div class="col hide-on-small-only m3 right-nav">
            <div class="table-of-contents fixed">
                
                    <ul>
<li><a class="reference internal" href="#">gino.crud module</a></li>
</ul>

                
            </div>
        </div>

    </div>
    <div class="fixed-action-btn click-to-toggle">
        <a class="btn-floating btn-large blue">
            <i class="mdi mdi-translate"></i>
        </a>
        <ul>
            <li><a href="/docs/en/master" class="btn-floating blue">EN</a></li>
            <li><a href="/docs/zh/master" class="btn-floating red">ZH</a></li>
        </ul>
    </div>
</main>

<script type="text/javascript"
        src="../../_static/js/materialize.min.js"></script>
<script type="text/javascript"
        src="../../_static/js/gino.js"></script>
</body>
</html>