<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="icon" href="../_static/favicon.ico">
    <title>Bake Queries - GINO 1.1.0a0 documentation</title>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async
            src="https://www.googletagmanager.com/gtag/js?id=UA-3759436-10"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag () {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-3759436-10');
    </script>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Raleway:400,500,600,700&display=swap">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css">
    <link type="text/css" rel="stylesheet"
          href="../_static/css/materialize.min.css"
          media="screen,projection"/>
    <link rel="stylesheet" href="../_static/pygments.css"
          type="text/css"/>
    <link type="text/css" rel="stylesheet"
          href="../_static/css/gino.css"/>
</head>
<body>

<header>
    <div class="navbar-fixed">
        <nav>
            <div class="nav-wrapper">
                <a href="#" data-target="sidenav" class="sidenav-trigger"><hr><hr><hr></a>
                <a href="../index.html" class="brand-logo">
                    <div class="img"
                         style="background-image: url(../_static/logo.svg); width: 103px; height: 40px;"></div>
                </a>
                <div class="breadcrumbs">
                    <a class="breadcrumb" style="display: none"></a>
                    
                        <a href="../how-to.html"
                           class="breadcrumb">How-to Guides</a>
                    
                    
                        <a class="breadcrumb" style="color: #FFFFFF">Bake Queries</a>
                    
                </div>
                <div class="spacer"></div>
                <div id="search-container" class="search">
                    <input type="text" id="search" placeholder="Search">
                    <i class="mdi mdi-magnify"></i>
                    <div id="search-results" style="display: none"></div>
                </div>
                <a class="btn-flat theme-dark" href="/">
                    HOME
                </a>
                <a class="btn-flat theme-dark" href="/authors.html">
                    CREDITS
                </a>
                <a href="https://github.com/python-gino/gino" target="_blank"
                   class="github-stars">
                    <div class="left"><img
                        src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDNweCIgaGVpZ2h0PSI0MnB4IiB2aWV3Qm94PSIwIDAgNDMgNDIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYxLjIgKDg5NjUzKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5GaWxsIDQ5PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlYzLeacgOaWsOeov+S7tiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkhPTUUtdjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNTA3LjAwMDAwMCwgLTQ5LjAwMDAwMCkiIGZpbGw9IiNGRkZGRkUiPgogICAgICAgICAgICA8ZyBpZD0iYmFubmVyLWJnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzc5LjAwMDAwMCwgLTE4Ny4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJoZWFkZXIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU5Ny4wMDAwMDAsIDIxOC4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTMxMC40OTgwMiwxOCBDMTI5OC42MjcxMiwxOCAxMjg5LDI3LjYzOTg4MzEgMTI4OSwzOS41MzIxMTIzIEMxMjg5LDQ5LjA0NTEwMjYgMTI5NS4xNTk4Myw1Ny4xMTQ2ODggMTMwMy43MDMzNCw1OS45NjE4NDM5IEMxMzA0Ljc3OTAzLDYwLjE2MDExMzggMTMwNS4xNzEwMyw1OS40OTUyNDg3IDEzMDUuMTcxMDMsNTguOTI0MjMxMyBDMTMwNS4xNzEwMyw1OC40MTI2OTUgMTMwNS4xNTI1NSw1Ny4wNTkxNzI0IDEzMDUuMTQxOTksNTUuMjYyODQ3IEMxMjk5LjE2MTY3LDU2LjU2MzQ5NzYgMTI5Ny44OTk4Nyw1Mi4zNzYwMzcxIDEyOTcuODk5ODcsNTIuMzc2MDM3MSBDMTI5Ni45MjE4NSw0OS44ODg0MTA2IDEyOTUuNTEyMjMsNDkuMjI2MTg5MSAxMjk1LjUxMjIzLDQ5LjIyNjE4OTEgQzEyOTMuNTYwMTUsNDcuODkxMTcxNyAxMjk1LjY2MDA2LDQ3LjkxNzYwNzcgMTI5NS42NjAwNiw0Ny45MTc2MDc3IEMxMjk3LjgxODA0LDQ4LjA2OTYxNDYgMTI5OC45NTMxMyw1MC4xMzY5MDg5IDEyOTguOTUzMTMsNTAuMTM2OTA4OSBDMTMwMC44NzA5LDUzLjQyNjg2NzYgMTMwMy45ODU3OSw1Mi40NzY0OTM4IDEzMDUuMjEwNjMsNTEuOTI1MzAzNSBDMTMwNS40MDU5Nyw1MC41MzQ3NzA1IDEzMDUuOTYxNjMsNDkuNTg1NzE4NiAxMzA2LjU3NTM3LDQ5LjA0Nzc0NjIgQzEzMDEuODAxNDEsNDguNTA0NDg2NiAxMjk2Ljc4MTk1LDQ2LjY1NjYxMTEgMTI5Ni43ODE5NSwzOC40MDU5MzkyIEMxMjk2Ljc4MTk1LDM2LjA1NTc3OTkgMTI5Ny42MjAwNiwzNC4xMzI1NjE3IDEyOTguOTk1MzcsMzIuNjI4MzU0IEMxMjk4Ljc3MzYzLDMyLjA4Mzc3MjYgMTI5OC4wMzU4MiwyOS44OTM1NTEgMTI5OS4yMDY1NCwyNi45MzAwNzY4IEMxMjk5LjIwNjU0LDI2LjkzMDA3NjggMTMwMS4wMTA4LDI2LjM1MTEyODYgMTMwNS4xMTgyNCwyOS4xMzc0ODE4IEMxMzA2LjgzMjc1LDI4LjY1ODk5MDQgMTMwOC42NzI2NCwyOC40MjEwNjY1IDEzMTAuNTAwNjYsMjguNDExODEzOSBDMTMxMi4zMjczNiwyOC40MjEwNjY1IDEzMTQuMTY1OTQsMjguNjU4OTkwNCAxMzE1Ljg4MzA4LDI5LjEzNzQ4MTggQzEzMTkuOTg3ODgsMjYuMzUxMTI4NiAxMzIxLjc4OTUsMjYuOTMwMDc2OCAxMzIxLjc4OTUsMjYuOTMwMDc2OCBDMTMyMi45NjI4NiwyOS44OTM1NTEgMTMyMi4yMjUwNSwzMi4wODM3NzI2IDEzMjIuMDA0NjMsMzIuNjI4MzU0IEMxMzIzLjM4MjU4LDM0LjEzMjU2MTcgMTMyNC4yMTQwOSwzNi4wNTU3Nzk5IDEzMjQuMjE0MDksMzguNDA1OTM5MiBDMTMyNC4yMTQwOSw0Ni42Nzc3NTk5IDEzMTkuMTg2NzIsNDguNDk3ODc3NiAxMzE0LjM5ODIzLDQ5LjAzMDU2MjggQzEzMTUuMTY5MDQsNDkuNjk1NDI3OSAxMzE1Ljg1NjY5LDUxLjAwOTI5NjUgMTMxNS44NTY2OSw1My4wMTcxMDk4IEMxMzE1Ljg1NjY5LDU1Ljg5NTk4ODkgMTMxNS44MzAyOSw1OC4yMTgzOTA1IDEzMTUuODMwMjksNTguOTI0MjMxMyBDMTMxNS44MzAyOSw1OS41MDA1MzU5IDEzMTYuMjE4MzMsNjAuMTcwNjg4MiAxMzE3LjMwODU0LDU5Ljk2MDUyMjEgQzEzMjUuODQ1NDUsNTcuMTA2NzU3MiAxMzMyLDQ5LjA0MjQ1OSAxMzMyLDM5LjUzMjExMjMgQzEzMzIsMjcuNjM5ODgzMSAxMzIyLjM3Mjg4LDE4IDEzMTAuNDk4MDIsMTgiIGlkPSJGaWxsLTQ5Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="
                        class="github-logo">
                        GitHub
                    </div>
                    <div class="right"><img
                        src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjFweCIgaGVpZ2h0PSIxOXB4IiB2aWV3Qm94PSIwIDAgMjEgMTkiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDYxLjIgKDg5NjUzKSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5QYXRoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlYzLeacgOaWsOeov+S7tiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkhPTUUtdjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNTYxLjAwMDAwMCwgLTYwLjAwMDAwMCkiIGZpbGw9IiNGOEQyMzAiPgogICAgICAgICAgICA8ZyBpZD0iYmFubmVyLWJnIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzc5LjAwMDAwMCwgLTE4Ny4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJoZWFkZXIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU5Ny4wMDAwMDAsIDIxOC4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8ZyBpZD0ibGFiZWwtY29weS0xMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTI4OS4wMDAwMDAsIDE4LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aCIgcG9pbnRzPSI2MS4wNTQzNTQzIDE3Ljc1NzM4MzYgNTQuMjE1MjQ2NiAxOC4zMTMzOTI5IDU5Ljg4OTM1MTcgMjIuOTczNzM4NyA1Ny43ODQ1MjI4IDI5Ljg0MDExODQgNjQuNDQyNTI3MSAyNi41NDM0MTg4IDcwLjU3NzcyMzkgMjkuODQwMTE4NCA2OS4yMzA0MzI1IDIyLjk3MzczODcgNzQuNzMyNTY5NiAxOC4zMTMzOTI5IDY3Ljg5MzQ2MiAxNy43NTczODM2IDY0LjQ0MjUyNzEgMTEuMzc1Ij48L3BvbHlnb24+CiAgICAgICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=">
                        <span id="github-star-num"></span>
                    </div>
                </a>
            </div>
        </nav>
    </div>

    <div id="sidenav" class="sidenav sidenav-fixed">
        <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/announcement.html">官宣：Python 异步编程再添一利器</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial.html">GINO Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/fastapi.html">Build a FastAPI Server</a></li>
</ul>
<p class="caption"><span class="caption-text">How-to Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../how-to.html">How-to Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="alembic.html">Use Alembic</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bake Queries</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="crud.html">CRUD</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="json-props.html">JSON Property</a></li>
<li class="toctree-l1"><a class="reference internal" href="loaders.html">Loaders and Relationship</a></li>
<li class="toctree-l1"><a class="reference internal" href="pool.html">Connection Pool</a></li>
<li class="toctree-l1"><a class="reference internal" href="schema.html">Schema Declaration</a></li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">Transaction</a></li>
</ul>
<p class="caption"><span class="caption-text">Explanation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../explanation.html">Explanation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/async.html">Asynchronous Programming 101</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/engine.html">Engine and Connection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../explanation/why.html">Why Asynchronous ORM?</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/extensions.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/history.html">History</a></li>
</ul>

    </div>
</header>

<main>
    <div class="row">
        <div class="col s12 m9 body">
            <div id="main-content" role="main">
                
    <div class="section" id="bake-queries">
<h1>Bake Queries<a class="headerlink" href="#bake-queries" title="Permalink to this headline">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.</span></p>
</div>
<p>Baked queries are used to boost execution performance for constantly-used queries.
Similar to the <a class="reference external" href="https://docs.sqlalchemy.org/en/13/orm/extensions/baked.html" title="(in SQLAlchemy v1.3)"><span>Baked Queries</span></a> in SQLAlchemy, GINO could also cache the
object’s construction and string-compilation steps. Furthermore, GINO automatically
manages a prepared statement for each baked query in every active connection in the
pool. Executing baked queries is at least 40% faster than running normal queries, but
you need to <strong>bake them before creating the engine</strong>.</p>
<p>GINO provides two approaches for baked queries:</p>
<ol class="arabic simple">
<li><p>Low-level <a class="reference internal" href="../reference/api/gino.bakery.html#gino.bakery.Bakery" title="gino.bakery.Bakery"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bakery</span></code></a> API</p></li>
<li><p>High-level <a class="reference internal" href="../reference/api/gino.api.html#gino.api.Gino.bake" title="gino.api.Gino.bake"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Gino.bake()</span></code></a> integration</p></li>
</ol>
<div class="section" id="use-bakery-with-bare-engine">
<h2>Use Bakery with Bare Engine<a class="headerlink" href="#use-bakery-with-bare-engine" title="Permalink to this headline">¶</a></h2>
<p>First, we need a bakery:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gino</span>

<span class="n">bakery</span> <span class="o">=</span> <span class="n">gino</span><span class="o">.</span><span class="n">Bakery</span><span class="p">()</span>
</pre></div>
</div>
<p>Then, let’s bake some queries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">db_time</span> <span class="o">=</span> <span class="n">bakery</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="s2">&quot;SELECT now()&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or queries with parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_query</span> <span class="o">=</span> <span class="n">bakery</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users WHERE id = :uid&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s assume we have this <code class="docutils literal notranslate"><span class="pre">users</span></code> table defined in SQLAlchemy Core:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlalchemy</span> <span class="k">as</span> <span class="nn">sa</span>

<span class="n">metadata</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">MetaData</span><span class="p">()</span>
<span class="n">user_table</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
    <span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">String</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Now we can bake a similar query with SQLAlchemy Core:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_query</span> <span class="o">=</span> <span class="n">bakery</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span>
    <span class="n">sa</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">user_table</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">sa</span><span class="o">.</span><span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;uid&quot;</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<p>These baked queries are usually global, and supposed to be shared across the
application. To run them, we need an engine with the bakery:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="k">await</span> <span class="n">gino</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://localhost/&quot;</span><span class="p">,</span> <span class="n">bakery</span><span class="o">=</span><span class="n">bakery</span><span class="p">)</span>
</pre></div>
</div>
<p>By doing so, GINO will bake the queries in the bakery. As new connections are added to
the DB pool, the prepared statements are automatically created behind the scene.</p>
<p>To execute the baked queries, you could treat the <a class="reference internal" href="../reference/api/gino.bakery.html#gino.bakery.BakedQuery" title="gino.bakery.BakedQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">BakedQuery</span></code></a>
instances as if they are the queries themselves, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">now</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">db_time</span><span class="p">)</span>
</pre></div>
</div>
<p>Pass in parameter values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="n">user_query</span><span class="p">,</span> <span class="n">uid</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="use-the-gino-integration">
<h2>Use the <a class="reference internal" href="../reference/api/gino.api.html#gino.api.Gino" title="gino.api.Gino"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gino</span></code></a> Integration<a class="headerlink" href="#use-the-gino-integration" title="Permalink to this headline">¶</a></h2>
<p>In a more common scenario, there will be a <code class="xref py py-class docutils literal notranslate"><span class="pre">Gino&gt;</span></code> instance, which has
usually a <code class="docutils literal notranslate"><span class="pre">bind</span></code> set - either explicitly or by the Web framework extensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gino</span> <span class="kn">import</span> <span class="n">Gino</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">Gino</span><span class="p">()</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">db</span><span class="o">.</span><span class="n">with_bind</span><span class="p">(</span><span class="s2">&quot;postgresql://localhost/&quot;</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>A <a class="reference internal" href="../reference/api/gino.bakery.html#gino.bakery.Bakery" title="gino.bakery.Bakery"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bakery</span></code></a> is automatically created in the <code class="docutils literal notranslate"><span class="pre">db</span></code> instance, and fed
to the engine implicitly. You can immediately start to bake queries without further
ado:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">)</span>

<span class="n">db_time</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="s2">&quot;SELECT now()&quot;</span><span class="p">)</span>
<span class="n">user_getter</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">db</span><span class="o">.</span><span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;uid&quot;</span><span class="p">)))</span>
</pre></div>
</div>
<p>And the execution is also simplified with the same <code class="docutils literal notranslate"><span class="pre">bind</span></code> magic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">async</span> <span class="k">with</span> <span class="n">db</span><span class="o">.</span><span class="n">with_bind</span><span class="p">(</span><span class="s2">&quot;postgresql://localhost/&quot;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="k">await</span> <span class="n">db_time</span><span class="o">.</span><span class="n">scalar</span><span class="p">())</span>

        <span class="n">user</span><span class="p">:</span> <span class="n">User</span> <span class="o">=</span> <span class="k">await</span> <span class="n">user_getter</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="n">uid</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>To make things more easier, you could even define the baked queries directly on the
model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s2">&quot;users&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">)</span>

    <span class="nd">@db</span><span class="o">.</span><span class="n">bake</span>
    <span class="k">def</span> <span class="nf">getter</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">db</span><span class="o">.</span><span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;uid&quot;</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">uid</span><span class="p">):</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">cls</span><span class="o">.</span><span class="n">getter</span><span class="o">.</span><span class="n">one_or_none</span><span class="p">(</span><span class="n">uid</span><span class="o">=</span><span class="n">uid</span><span class="p">)</span>
</pre></div>
</div>
<p>Here GINO treats the <code class="docutils literal notranslate"><span class="pre">getter()</span></code> as a <a class="reference internal" href="../reference/api/gino.declarative.html#gino.declarative.declared_attr" title="gino.declarative.declared_attr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">declared_attr()</span></code></a> with
<code class="docutils literal notranslate"><span class="pre">with_table=True</span></code>, therefore it takes one positional argument <code class="docutils literal notranslate"><span class="pre">cls</span></code> for the <code class="docutils literal notranslate"><span class="pre">User</span></code>
class.</p>
</div>
<div class="section" id="how-to-customize-loaders">
<h2>How to customize loaders?<a class="headerlink" href="#how-to-customize-loaders" title="Permalink to this headline">¶</a></h2>
<p>If possible, you could bake the additional execution options into the query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_getter</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span>
    <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">db</span><span class="o">.</span><span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;uid&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span>
        <span class="n">loader</span><span class="o">=</span><span class="n">User</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Added by loader.&quot;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../reference/api/gino.bakery.html#gino.bakery.Bakery.bake" title="gino.bakery.Bakery.bake"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bake()</span></code></a> method accepts keyword arguments as execution
options to e.g. simplify the example above into:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user_getter</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span>
    <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">db</span><span class="o">.</span><span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;uid&quot;</span><span class="p">)),</span>
    <span class="n">loader</span><span class="o">=</span><span class="n">User</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Added by loader.&quot;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If the query construction is complex, <a class="reference internal" href="../reference/api/gino.bakery.html#gino.bakery.Bakery.bake" title="gino.bakery.Bakery.bake"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bake()</span></code></a> could also be
used as a decorator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@db</span><span class="o">.</span><span class="n">bake</span>
<span class="k">def</span> <span class="nf">user_getter</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">db</span><span class="o">.</span><span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;uid&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">execution_options</span><span class="p">(</span>
        <span class="n">loader</span><span class="o">=</span><span class="n">User</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Added by loader.&quot;</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Or with short execution options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@db</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">User</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Added by loader.&quot;</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">user_getter</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">db</span><span class="o">.</span><span class="n">bindparam</span><span class="p">(</span><span class="s2">&quot;uid&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Meanwhile, it is also possible to override the loader at runtime:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span><span class="p">:</span> <span class="n">User</span> <span class="o">=</span> <span class="k">await</span> <span class="n">user_getter</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="n">uid</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># no more comment on user!</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>This override won’t affect the baked query - it’s used only in this execution.</p>
</div>
</div>
<div class="section" id="what-apis-are-available-on-bakedquery">
<h2>What APIs are available on <a class="reference internal" href="../reference/api/gino.bakery.html#gino.bakery.BakedQuery" title="gino.bakery.BakedQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">BakedQuery</span></code></a>?<a class="headerlink" href="#what-apis-are-available-on-bakedquery" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../reference/api/gino.bakery.html#gino.bakery.BakedQuery" title="gino.bakery.BakedQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">BakedQuery</span></code></a> is a <a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor" title="gino.api.GinoExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GinoExecutor</span></code></a>, so it inherited
all the APIs like <a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor.all" title="gino.api.GinoExecutor.all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all()</span></code></a>,
<a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor.first" title="gino.api.GinoExecutor.first"><code class="xref py py-meth docutils literal notranslate"><span class="pre">first()</span></code></a>, <a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor.one" title="gino.api.GinoExecutor.one"><code class="xref py py-meth docutils literal notranslate"><span class="pre">one()</span></code></a>,
<a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor.one_or_none" title="gino.api.GinoExecutor.one_or_none"><code class="xref py py-meth docutils literal notranslate"><span class="pre">one_or_none()</span></code></a>, <a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor.scalar" title="gino.api.GinoExecutor.scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scalar()</span></code></a>,
<a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor.status" title="gino.api.GinoExecutor.status"><code class="xref py py-meth docutils literal notranslate"><span class="pre">status()</span></code></a>, <a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor.load" title="gino.api.GinoExecutor.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a>,
<a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor.timeout" title="gino.api.GinoExecutor.timeout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">timeout()</span></code></a>, etc.</p>
<p><a class="reference internal" href="../reference/api/gino.api.html#gino.api.GinoExecutor" title="gino.api.GinoExecutor"><code class="xref py py-class docutils literal notranslate"><span class="pre">GinoExecutor</span></code></a> is actually the chained <code class="docutils literal notranslate"><span class="pre">.gino</span></code> helper API seen
usually in queries like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">user</span> <span class="o">=</span> <span class="k">await</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">User</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">123</span><span class="p">)</span><span class="o">.</span><span class="n">gino</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
</pre></div>
</div>
<p>So a <a class="reference internal" href="../reference/api/gino.bakery.html#gino.bakery.BakedQuery" title="gino.bakery.BakedQuery"><code class="xref py py-class docutils literal notranslate"><span class="pre">BakedQuery</span></code></a> can be seen as a normal query with the <code class="docutils literal notranslate"><span class="pre">.gino</span></code>
suffix, plus it is directly executable.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please see API document of <a class="reference internal" href="../reference/api/gino.bakery.html#module-gino.bakery" title="gino.bakery"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gino.bakery</span></code></a> for more information.</p>
</div>
</div>
</div>


            </div>
            <p style="text-align: center; font-size: 12px;">
                <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
                    <img
                        alt="Creative Commons License"
                        style="border-width:0"
                        src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png"
                    />
                </a>
                <br/>
                This work is licensed under a<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"> Creative Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
        </div>

        <div class="col hide-on-small-only m3 right-nav">
            <div class="table-of-contents fixed">
                
                    <ul>
<li><a class="reference internal" href="#">Bake Queries</a><ul>
<li><a class="reference internal" href="#use-bakery-with-bare-engine">Use Bakery with Bare Engine</a></li>
<li><a class="reference internal" href="#use-the-gino-integration">Use the <code class="xref py py-class docutils literal notranslate"><span class="pre">Gino</span></code> Integration</a></li>
<li><a class="reference internal" href="#how-to-customize-loaders">How to customize loaders?</a></li>
<li><a class="reference internal" href="#what-apis-are-available-on-bakedquery">What APIs are available on <code class="xref py py-class docutils literal notranslate"><span class="pre">BakedQuery</span></code>?</a></li>
</ul>
</li>
</ul>

                
                <div id="version-selector">
                    
                        <hr>
                    
                </div>
                <div class="add-your-lang">
                    <a href="https://www.transifex.com/decentfox-studio/gino_1_0/"
                       target="_blank">Add your language here.</a>
                </div>
            </div>
        </div>

    </div>
    <div class="fixed-action-btn click-to-toggle">
        <a class="btn-floating btn-large white">
            <img src="../_static/images/language.svg">
            <div>
              EN
            </div>
        </a>
        <ul id="lang-selector">
        </ul>
    </div>
</main>

<script type="text/javascript" src="../_static/js/materialize.min.js"></script>
<script type="text/javascript" src="../_static/js/language_data.js"></script>
<script id="documentation_options" data-url_root="../" src="../_static/js/documentation_options.js"></script>
<script type="text/javascript" src="../_static/js/underscore.js"></script>
<script type="text/javascript" src="../_static/js/jquery.js"></script>
<script type="text/javascript">
    var sver = 'master';
    var language = 'en';
    var pagename = 'how-to/bakery';
</script>
<script type="text/javascript" src="../_static/js/gino.js"></script>
<script type="text/javascript" src="../searchindex.js"></script>
</body>
</html>